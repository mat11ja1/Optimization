function D = bfgs(D, p, q)
    D = D ...
        + (1 + (q' * D * q) / (p' * q)) * 1 / (p' * q) * p * p' ...
        - 1 / (p' * q) * (p * q' * D + D * q * p');
end